% wImageXYZ2rgb
% 
% Calculate XYZ values (0-1) from rgb values (CIE1931 coordinates) 
% with tonemap procedure.
%
%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Usage: 
%    rgb = XYZ2rgb(XYZ, ccmat);
%   
% Input:  
%   XYZ(image): [iy ix 3]
%   lw: parameter of Reinhard function
%   ccmat:  color conversion matrix created by makeccmatrix.m
%
% Output:
%   rgb:    rgb vector or matrices
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 

function rgb = wImageXYZ2rgb(XYZ, lw, ccmatrix)

    XYZ = wTonemap(XYZ,lw,ccmatrix);
    
    rgb = XYZ2rgb(XYZ,ccmat);
    
    LUT = load('mat/20191108_w.lut');
    %rgb = uint8(rgb2RGB_LUT(rgb',LUT)/257);
    
    rgb =reshape(rgb,iy,ix,3);
    
    imshow(rgb);

end



